<div class="task-widget" class="slide-pop">
    <div class="task-lists">
        <ul class="nav nav-pills nav-stacked">
            <li ng-class="{active: currentList.title == list.title}" 
                ng-repeat="list in lists track by $index">
                <a data-toggle="tab" href="#{{list.listId}}">
                    <span class="badge pull-right">{{list.remainingCount}}</span>
                    <div class="destroy pull-right glyphicon glyphicon-trash" ng-click="removeList(list)"></div>
                    <strong>{{list.title}}</strong>
                </a>
            </li>
        </ul>
        <form id="list-form" ng-submit="addList()">
            <div class="input-group new-list">
                <input id="new-list" placeholder="Create a new list..." ng-model="newList" autofocus
                       class="form-control">
        <span class="input-group-btn">
          <div class="btn new-list" ng-click="addList()">
            <span class="glyphicon glyphicon-plus"></span>
          </div>
        </span>
            </div>
        </form>
        <button type="button" class="btn btn-large btn-block btn-default form-control" ng-click="reload()">clear storage (remove in
            production)
        </button>
    </div>

    <div class="tab-content tasks">
        <div class="tab-pane active" id="{{currentList}}">      
            <ul>
                <li ng-repeat="task in tasks track by $index" class="task-listing">
                    <input type="checkbox" ng-model="task.completed">
                    <label>
                        <div class="glyphicon glyphicon-ok"></div>
                    </label>
                    <span>{{task.title}}</span>

                    <div class="destroy glyphicon glyphicon-trash pull-right destroy-task"
                         ng-click="removeTask(task)"></div>
                </li>
            </ul>
        </div>
        <uib-accordion close-others="true" class="tab-content tasks" >
            <uib-accordion-group
                    ng-repeat="task in tasks track by $index"
                    panel-class="{{{high:'panel-danger', medium:'panel-warning', generic:'panel-info'}[task.priority]}}"
                    is-open="task.open">
                <uib-accordion-heading ng-click="task.open = !task.open">
                    <input type='checkbox' ng-model='task.completed' > {{task.title}}
                    <br ng-show="task.endTime">
                    <span ng-show="task.endTime" class="info"> Remaining: {{task.endTime | amDifference : null : 'seconds'| amDurationFormat : 'second' }}</span>

                    <i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-down': task.open, 'glyphicon-chevron-right': !task.open}"></i>
                    <div class="destroy glyphicon glyphicon-trash pull-right destroy-task"
                         ng-click="removeTask(task)"></div>
                </uib-accordion-heading>
                <uib-accordion-content>
                    <span am-time-ago="now"></span>
                    Start: {{ task.startTime | date:"MM/dd/yyyy 'at' HH:mm"}} <br>
                    End: {{ task.endTime | date:"MM/dd/yyyy 'at' HH:mm"}} <br>
                    Left: {{now | amDifference : task.startTime : 'seconds' | amDurationFormat : 'second' }}<br>
                    Remaining: {{task.endTime | amDifference : null : 'seconds'| amDurationFormat : 'second' }}<br>
                    All: {{task.endTime | amDifference : task.startTime : 'seconds' | amDurationFormat : 'second'  }}<br>
                    <uib-progressbar max="100" value="task.progress" class="progress-striped active" type="success">
                        <span style="color:white; white-space:nowrap;">{{task.progress}} %</span>
                    </uib-progressbar>
                    <div class="text-center" ng-hide="task.subtasks">
                        <span class="info">No tasks yet</span>
                    </div>
                </uib-accordion-content>
            </uib-accordion-group>
        </uib-accordion>
        <hr />
        <form id="task-form" ng-submit="addTask()">
            <div class="input-group new-task">
                <input id="new-task" placeholder="Create a new taskâ€¦" ng-model="newTask.name" autofocus
                       class="form-control">
                <div class="settings">
                    <div class="dropdown form-control" style="display: inline-block">
                        <a class="btn btn-info dropdown-toggle" id="dropdown1" role="button" data-toggle="dropdown"
                           href="#/" ng-bind="newTask.startTime || 'Set start time' | date:'MM/dd/yyyy HH:mm'"></a>
                        <ul class="dropdown-menu" role="menu">
                            <datetimepicker data-ng-model="newTask.startTime"
                                            data-datetimepicker-config="{ dropdownSelector: '#dropdown1' }"/>
                        </ul>
                    </div>
                    <div class="dropdown form-control" style="display: inline-block">
                        <a class="btn btn-info dropdown-toggle" id="dropdown2" role="button" data-toggle="dropdown"
                           href="#/" ng-bind="newTask.endTime || 'Set end time' | date:'MM/dd/yyyy HH:mm'"></a>
                        <ul class="dropdown-menu" role="menu">
                            <datetimepicker data-ng-model="newTask.endTime"
                                            data-datetimepicker-config="{ dropdownSelector: '#dropdown2' }"/>
                        </ul>
                    </div>
                </div>

          <span class="input-group-btn">
            <div class="btn add-task-btn" ng-click="addTask()" type=button>
              <span class="glyphicon glyphicon-plus"></span>
            </div>
          </span>
            </div>
        </form>
    </div><!-- tab-content -->
</div><!-- task-widget -->
